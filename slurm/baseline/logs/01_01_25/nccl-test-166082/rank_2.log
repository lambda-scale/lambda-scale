Rank [2]: Total nodes: 2, using device 0, block_to_group_rank_map: {0: [0, 2], 1: [1, 3], 2: [0, 2], 3: [1, 3]}.
[rank2]:[W102 06:35:50.407061266 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-39:3530536:3530536 [0] NCCL INFO cudaDriverVersion 12020
dgx-39:3530536:3530536 [0] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.61<0>
dgx-39:3530536:3530536 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-39:3530536:3530536 [0] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [2]mlx5_2:1/RoCE [3]mlx5_3:1/IB [4]mlx5_4:1/IB [5]mlx5_5:1/IB [6]mlx5_6:1/IB [7]mlx5_7:1/IB [8]mlx5_8:1/RoCE [9]mlx5_9:1/IB [10]mlx5_10:1/IB [11]mlx5_11:1/IB [RO]; OOB ibp24s0:10.23.1.61<0>
dgx-39:3530536:3530919 [0] NCCL INFO Using non-device net plugin version 0
dgx-39:3530536:3530919 [0] NCCL INFO Using network IB
dgx-39:3530536:3530919 [0] NCCL INFO ncclCommInitRank comm 0x8349620 rank 2 nranks 4 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1f94c676333bda72 - Init START
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-39:3530536:3530919 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-39:3530536:3530919 [0] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-39:3530536:3530919 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-39:3530536:3530919 [0] NCCL INFO comm 0x8349620 rank 2 nRanks 4 nNodes 2 localRanks 2 localRank 0 MNNVL 0
dgx-39:3530536:3530919 [0] NCCL INFO Trees [0] 3/-1/-1->2->0 [1] -1/-1/-1->2->3 [2] 3/-1/-1->2->0 [3] -1/-1/-1->2->3 [4] 3/0/-1->2->-1 [5] -1/-1/-1->2->3 [6] 3/0/-1->2->-1 [7] -1/-1/-1->2->3
dgx-39:3530536:3530919 [0] NCCL INFO P2P Chunksize set to 131072
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 1 from local rank 1, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec005db0
dgx-39:3530536:3530919 [0] NCCL INFO Channel 00/0 : 1[1] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec005ea0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 3 from local rank 1, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Channel 02/0 : 1[1] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 4 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec005f90
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 5 from local rank 1, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Channel 04/0 : 1[1] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 6 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006080
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 7 from local rank 1, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Channel 06/0 : 1[1] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO Channel 00/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006170
dgx-39:3530536:3530919 [0] NCCL INFO Channel 02/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 9 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0061e8
dgx-39:3530536:3530919 [0] NCCL INFO Channel 04/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 10 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006260
dgx-39:3530536:3530919 [0] NCCL INFO Channel 06/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 11 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0062d8
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 12 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006350
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 13 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0063c8
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 14 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006440
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 15 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0064b8
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006008
dgx-39:3530536:3530919 [0] NCCL INFO Channel 01/0 : 2[0] -> 1[1] [send] via NET/IB/3(3)/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec0060f8
dgx-39:3530536:3530919 [0] NCCL INFO Channel 03/0 : 2[0] -> 1[1] [send] via NET/IB/3(3)/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec0061e8
dgx-39:3530536:3530919 [0] NCCL INFO Channel 05/0 : 2[0] -> 1[1] [send] via NET/IB/3(3)/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006350
dgx-39:3530536:3530919 [0] NCCL INFO Channel 07/0 : 2[0] -> 1[1] [send] via NET/IB/3(3)/GDRDMA
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1891 mtu 5 LID 557 fifoRkey=0x179c5c fifoLkey=0x179c5c
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1894 mtu 5 LID 557 fifoRkey=0x17a868 fifoLkey=0x17a868
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1897 mtu 5 LID 557 fifoRkey=0x1808c8 fifoLkey=0x1808c8
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1900 mtu 5 LID 557 fifoRkey=0x178747 fifoLkey=0x178747
dgx-39:3530536:3530919 [0] NCCL INFO Connected all rings
dgx-39:3530536:3530919 [0] NCCL INFO Channel 01/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 16 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006530
dgx-39:3530536:3530919 [0] NCCL INFO Channel 03/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 17 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0065a8
dgx-39:3530536:3530919 [0] NCCL INFO Channel 05/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 18 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006620
dgx-39:3530536:3530919 [0] NCCL INFO Channel 07/0 : 2[0] -> 3[1] via P2P/CUMEM
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 19 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006698
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 20 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006710
dgx-39:3530536:3530919 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 21 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006788
dgx-39:3530536:3530919 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 22 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006800
dgx-39:3530536:3530919 [0] NCCL INFO Channel 04/0 : 0[0] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 23 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006878
dgx-39:3530536:3530919 [0] NCCL INFO Channel 06/0 : 0[0] -> 2[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 24 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0068f0
dgx-39:3530536:3530919 [0] NCCL INFO Channel 00/0 : 2[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 25 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006968
dgx-39:3530536:3530919 [0] NCCL INFO Channel 02/0 : 2[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 26 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec0069e0
dgx-39:3530536:3530919 [0] NCCL INFO Channel 04/0 : 2[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 27 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006a58
dgx-39:3530536:3530919 [0] NCCL INFO Channel 06/0 : 2[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 28 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006ad0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 29 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006b48
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 30 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006bc0
dgx-39:3530536:3530961 [0] NCCL INFO New proxy recv connection 31 from local rank 0, transport 0
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006c38
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1903 mtu 5 LID 557 fifoRkey=0x17d696 fifoLkey=0x17d696
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1906 mtu 5 LID 557 fifoRkey=0x17ecac fifoLkey=0x17ecac
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1909 mtu 5 LID 557 fifoRkey=0x17e5a4 fifoLkey=0x17e5a4
dgx-39:3530536:3530961 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1912 mtu 5 LID 557 fifoRkey=0x1816d6 fifoLkey=0x1816d6
dgx-39:3530536:3530919 [0] NCCL INFO Connected all trees
dgx-39:3530536:3530919 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
dgx-39:3530536:3530919 [0] NCCL INFO 8 coll channels, 8 collnet channels, 0 nvls channels, 8 p2p channels, 2 p2p channels per peer
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 32 from local rank 0, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551ec006cb0
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-39:3530536:3530919 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006d28
dgx-39:3530536:3530961 [0] NCCL INFO New proxy send connection 33 from local rank 1, transport 2
dgx-39:3530536:3530919 [0] NCCL INFO ncclCommInitRank comm 0x8349620 rank 2 nranks 4 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1f94c676333bda72 - Init COMPLETE
Rank [2]: block_names: ['block_0_rank_0', 'block_1_rank_0', 'block_2_rank_0', 'block_3_rank_0']
Rank [2]: Received model_metadata: {'block_shape': torch.Size([1684603904])}
Rank [2]: Preparing GPU blocks...
Rank [2]: Total 2 blocks in device 0.
Rank [2]: Verifying block 0, 0.0
Rank [2]: Verifying block 2, 0.0
Rank [2]: broadcasting Block ID 0 calling from rank 0 for group [0, 2]...
dgx-39:3530536:3530984 [0] NCCL INFO Using non-device net plugin version 0
dgx-39:3530536:3530984 [0] NCCL INFO Using network IB
dgx-39:3530536:3530984 [0] NCCL INFO ncclCommInitRank comm 0x8b2ae60 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x3a5ab0fc3c8eafb7 - Init START
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-39:3530536:3530984 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530984 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-39:3530536:3530984 [0] NCCL INFO comm 0x8b2ae60 rank 1 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-39:3530536:3530984 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] 0/-1/-1->1->-1 [3] 0/-1/-1->1->-1
dgx-39:3530536:3530984 [0] NCCL INFO P2P Chunksize set to 131072
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530987 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80005db0
dgx-39:3530536:3530984 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530987 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80005e28
dgx-39:3530536:3530984 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530987 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80005ea0
dgx-39:3530536:3530984 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530987 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80005f18
dgx-39:3530536:3530984 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530987 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80005f90
dgx-39:3530536:3530984 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530987 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80006008
dgx-39:3530536:3530984 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530987 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80006080
dgx-39:3530536:3530984 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530984 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530987 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e800060f8
dgx-39:3530536:3530984 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530987 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1915 mtu 5 LID 557 fifoRkey=0x1802c2 fifoLkey=0x1802c2
dgx-39:3530536:3530987 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1918 mtu 5 LID 557 fifoRkey=0x17cc8c fifoLkey=0x17cc8c
dgx-39:3530536:3530987 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1921 mtu 5 LID 557 fifoRkey=0x179252 fifoLkey=0x179252
dgx-39:3530536:3530987 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1924 mtu 5 LID 557 fifoRkey=0x177b3b fifoLkey=0x177b3b
dgx-39:3530536:3530984 [0] NCCL INFO Connected all rings
dgx-39:3530536:3530984 [0] NCCL INFO Connected all trees
dgx-39:3530536:3530984 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-39:3530536:3530984 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-39:3530536:3530987 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-39:3530536:3530984 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e80006170
Rank [2]: broadcasting Block ID 2 calling from rank 0 for group [0, 2]...
dgx-39:3530536:3530984 [0] NCCL INFO ncclCommInitRank comm 0x8b2ae60 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x3a5ab0fc3c8eafb7 - Init COMPLETE
dgx-39:3530536:3530992 [0] NCCL INFO Using non-device net plugin version 0
dgx-39:3530536:3530992 [0] NCCL INFO Using network IB
dgx-39:3530536:3530992 [0] NCCL INFO ncclCommInitRank comm 0x8b3fe60 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xa6bdb8e4a5150f80 - Init START
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-39:3530536:3530992 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530992 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-39:3530536:3530992 [0] NCCL INFO comm 0x8b3fe60 rank 1 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-39:3530536:3530992 [0] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0 [2] 0/-1/-1->1->-1 [3] 0/-1/-1->1->-1
dgx-39:3530536:3530992 [0] NCCL INFO P2P Chunksize set to 131072
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530996 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78005db0
dgx-39:3530536:3530992 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530996 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78005e28
dgx-39:3530536:3530992 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530996 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78005ea0
dgx-39:3530536:3530992 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-39:3530536:3530996 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78005f18
dgx-39:3530536:3530992 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [receive] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530996 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78005f90
dgx-39:3530536:3530992 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530996 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78006008
dgx-39:3530536:3530992 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530996 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78006080
dgx-39:3530536:3530992 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530992 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-39:3530536:3530996 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e780060f8
dgx-39:3530536:3530992 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [send] via NET/IB/0/GDRDMA
dgx-39:3530536:3530996 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1927 mtu 5 LID 557 fifoRkey=0x177132 fifoLkey=0x177132
dgx-39:3530536:3530996 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1930 mtu 5 LID 557 fifoRkey=0x175d1d fifoLkey=0x175d1d
dgx-39:3530536:3530996 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1931 mtu 5 LID 557 fifoRkey=0x175111 fifoLkey=0x175111
dgx-39:3530536:3530996 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 1936 mtu 5 LID 557 fifoRkey=0x17ad6d fifoLkey=0x17ad6d
dgx-39:3530536:3530992 [0] NCCL INFO Connected all rings
dgx-39:3530536:3530992 [0] NCCL INFO Connected all trees
dgx-39:3530536:3530992 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-39:3530536:3530992 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-39:3530536:3530996 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-39:3530536:3530992 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154e78006170
dgx-39:3530536:3530992 [0] NCCL INFO ncclCommInitRank comm 0x8b3fe60 rank 1 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xa6bdb8e4a5150f80 - Init COMPLETE
Rank [2]: verifying block 0 with 1.2516975402832031e-06
[rank2]: Traceback (most recent call last):
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 448, in <module>
[rank2]:     main()
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 445, in main
[rank2]:     broadcast_model(rank, world_size, model_name, args.num_blocks, args.use_multi_gpu)
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 404, in broadcast_model
[rank2]:     broadcast_model_instance_across_gpu(rank, world_size, model_name, num_blocks)
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 398, in broadcast_model_instance_across_gpu
[rank2]:     print(f"Rank [{rank}]: verifying block {i} with {blocks_gpu[i].flatten()[0].item()}") 
[rank2]: KeyError: 1
dgx-39:3530536:3530987 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-39:3530536:3531000 [0] NCCL INFO comm 0x8b2ae60 rank 1 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
dgx-39:3530536:3530996 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-39:3530536:3530961 [0] NCCL INFO [Service thread] Connection closed by localRank 1
dgx-39:3530536:3531004 [0] NCCL INFO comm 0x8b3fe60 rank 1 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
[rank2]:[W102 06:36:07.330286846 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
dgx-39:3530536:3530961 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-39:3530536:3531006 [0] NCCL INFO comm 0x8349620 rank 2 nranks 4 cudaDev 0 busId 1b000 - Abort COMPLETE
