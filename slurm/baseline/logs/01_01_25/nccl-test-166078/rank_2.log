Rank [2]: using device 2, block_to_group_rank_map: {0: [0, 4], 1: [1, 5], 2: [2, 6], 3: [3, 7], 4: [0, 4], 5: [1, 5], 6: [2, 6], 7: [3, 7]}.
[rank2]:[W102 05:45:27.545132505 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-35:1125061:1125061 [2] NCCL INFO cudaDriverVersion 12020
dgx-35:1125061:1125061 [2] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.29<0>
dgx-35:1125061:1125061 [2] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-35:1125061:1125061 [2] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [2]mlx5_2:1/RoCE [3]mlx5_3:1/IB [4]mlx5_4:1/IB [5]mlx5_5:1/IB [6]mlx5_6:1/IB [7]mlx5_7:1/IB [8]mlx5_8:1/RoCE [9]mlx5_9:1/IB [10]mlx5_10:1/IB [11]mlx5_11:1/IB [RO]; OOB ibp24s0:10.23.1.29<0>
dgx-35:1125061:1130709 [2] NCCL INFO Using non-device net plugin version 0
dgx-35:1125061:1130709 [2] NCCL INFO Using network IB
dgx-35:1125061:1130709 [2] NCCL INFO ncclCommInitRank comm 0x8370960 rank 2 nranks 8 cudaDev 2 nvmlDev 2 busId 52000 commId 0xd44f7765c042782e - Init START
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-35:1125061:1130709 [2] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-35:1125061:1130709 [2] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125061:1130709 [2] NCCL INFO Setting affinity for GPU 2 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1125061:1130709 [2] NCCL INFO comm 0x8370960 rank 2 nRanks 8 nNodes 2 localRanks 4 localRank 2 MNNVL 0
dgx-35:1125061:1130709 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1 [2] 3/6/-1->2->-1 [3] -1/-1/-1->2->1 [4] 3/-1/-1->2->1 [5] 3/-1/-1->2->1 [6] 3/6/-1->2->-1 [7] -1/-1/-1->2->1 [8] 3/-1/-1->2->1 [9] 3/-1/-1->2->1 [10] 3/-1/-1->2->6 [11] -1/-1/-1->2->1 [12] 3/-1/-1->2->1 [13] 3/-1/-1->2->1 [14] 3/-1/-1->2->6 [15] -1/-1/-1->2->1
dgx-35:1125061:1130709 [2] NCCL INFO P2P Chunksize set to 131072
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 0 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4005db0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 1 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4005e28
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 2 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4005ea0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 3 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4005f18
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 4 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4005f90
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 5 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006008
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 6 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006080
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 7 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40060f8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 01/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 8 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006170
dgx-35:1125061:1130709 [2] NCCL INFO Channel 05/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 9 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40061e8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 09/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 10 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006260
dgx-35:1125061:1130709 [2] NCCL INFO Channel 13/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 11 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40062d8
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 12 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006350
dgx-35:1125061:1130709 [2] NCCL INFO Channel 02/0 : 6[2] -> 2[2] [receive] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 13 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40063c8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 06/0 : 6[2] -> 2[2] [receive] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 14 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006440
dgx-35:1125061:1130709 [2] NCCL INFO Channel 10/0 : 6[2] -> 2[2] [receive] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 15 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40064b8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 14/0 : 6[2] -> 2[2] [receive] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 16 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006530
dgx-35:1125061:1130709 [2] NCCL INFO Channel 03/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 17 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40065a8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 07/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 18 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006620
dgx-35:1125061:1130709 [2] NCCL INFO Channel 11/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 19 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006698
dgx-35:1125061:1130709 [2] NCCL INFO Channel 15/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 20 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006710
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 21 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006788
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 22 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006800
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 23 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006878
dgx-35:1125061:1130709 [2] NCCL INFO Channel 00/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 24 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40068f0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 02/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 25 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006968
dgx-35:1125061:1130709 [2] NCCL INFO Channel 04/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 26 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40069e0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 06/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 27 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006a58
dgx-35:1125061:1130709 [2] NCCL INFO Channel 08/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 28 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006ad0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 10/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 29 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006b48
dgx-35:1125061:1130709 [2] NCCL INFO Channel 12/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 30 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006bc0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 14/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 31 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006c38
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 705 mtu 5 LID 271 fifoRkey=0x178e4e fifoLkey=0x178e4e
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 706 mtu 5 LID 271 fifoRkey=0x16c988 fifoLkey=0x16c988
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 707 mtu 5 LID 271 fifoRkey=0x17fcbd fifoLkey=0x17fcbd
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 708 mtu 5 LID 271 fifoRkey=0x16b171 fifoLkey=0x16b171
dgx-35:1125061:1130709 [2] NCCL INFO Connected all rings
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 32 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006cb0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 33 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006d28
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 34 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006da0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 35 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006e18
dgx-35:1125061:1130709 [2] NCCL INFO Channel 00/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 36 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006e90
dgx-35:1125061:1130709 [2] NCCL INFO Channel 02/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 37 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006f08
dgx-35:1125061:1130709 [2] NCCL INFO Channel 04/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 38 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006f80
dgx-35:1125061:1130709 [2] NCCL INFO Channel 06/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 39 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4006ff8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 08/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 40 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007070
dgx-35:1125061:1130709 [2] NCCL INFO Channel 10/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 41 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40070e8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 12/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 42 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007160
dgx-35:1125061:1130709 [2] NCCL INFO Channel 14/0 : 2[2] -> 3[3] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 43 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40071d8
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 44 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007250
dgx-35:1125061:1130709 [2] NCCL INFO Channel 02/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 45 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40072c8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 06/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 46 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007340
dgx-35:1125061:1130709 [2] NCCL INFO Channel 10/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 47 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40073b8
dgx-35:1125061:1130709 [2] NCCL INFO Channel 14/0 : 2[2] -> 6[2] [send] via NET/IB/4/GDRDMA
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 48 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007430
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 49 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40074a8
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 50 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007520
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 51 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007598
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 52 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007610
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 53 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007688
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 54 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007700
dgx-35:1125061:1130785 [2] NCCL INFO New proxy recv connection 55 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007778
dgx-35:1125061:1130709 [2] NCCL INFO Channel 01/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 56 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40077f0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 03/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 57 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007868
dgx-35:1125061:1130709 [2] NCCL INFO Channel 05/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 58 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40078e0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 07/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 59 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007958
dgx-35:1125061:1130709 [2] NCCL INFO Channel 09/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 60 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f40079d0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 11/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 61 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007a48
dgx-35:1125061:1130709 [2] NCCL INFO Channel 13/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 62 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007ac0
dgx-35:1125061:1130709 [2] NCCL INFO Channel 15/0 : 2[2] -> 1[1] via P2P/CUMEM
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 63 from local rank 2, transport 0
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007b38
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 717 mtu 5 LID 271 fifoRkey=0x1734f4 fifoLkey=0x1734f4
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 718 mtu 5 LID 271 fifoRkey=0x169959 fifoLkey=0x169959
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 719 mtu 5 LID 271 fifoRkey=0x175717 fifoLkey=0x175717
dgx-35:1125061:1130785 [2] NCCL INFO NET/IB: NCCL Dev 4 IbDev 4 Port 1 qpn 720 mtu 5 LID 271 fifoRkey=0x171cdc fifoLkey=0x171cdc
dgx-35:1125061:1130709 [2] NCCL INFO Connected all trees
dgx-35:1125061:1130709 [2] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 512 | 512
dgx-35:1125061:1130709 [2] NCCL INFO 16 coll channels, 16 collnet channels, 0 nvls channels, 16 p2p channels, 2 p2p channels per peer
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 64 from local rank 2, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007bb0
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 1
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007c28
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551f4007ca0
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 65 from local rank 0, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4007c28
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 66 from local rank 1, transport 2
dgx-35:1125061:1130785 [2] NCCL INFO New proxy send connection 67 from local rank 3, transport 2
dgx-35:1125061:1130709 [2] NCCL INFO ncclCommInitRank comm 0x8370960 rank 2 nranks 8 cudaDev 2 nvmlDev 2 busId 52000 commId 0xd44f7765c042782e - Init COMPLETE
Rank [2]: block_names: ['block_0_rank_0', 'block_1_rank_0', 'block_2_rank_0', 'block_3_rank_0', 'block_4_rank_0', 'block_5_rank_0', 'block_6_rank_0', 'block_7_rank_0']
Rank [2]: Received model_metadata: {'block_shape': torch.Size([8622081024])}
Rank [2]: blocks size 8
Rank [2]: Block 0 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0002956390380859375
Rank [2]: Block 1 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0002689361572265625
Rank [2]: Block 2 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.00439453125
Rank [2]: Block 3 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0087890625
Rank [2]: Block 4 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.00045013427734375
Rank [2]: Block 5 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.006683349609375
Rank [2]: Block 6 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0172119140625
Rank [2]: Block 7 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0091552734375
[rank2]: Traceback (most recent call last):
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 428, in <module>
[rank2]:     if __name__ == "__main__":
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 425, in main
[rank2]:     world_size = int(os.getenv("SLURM_NTASKS", torch.cuda.device_count()))
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 384, in broadcast_model
[rank2]:     if use_multi_gpu == 1:
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 344, in broadcast_model_instance_across_gpu
[rank2]:     block_shape = model_metadata["block_shape"]
[rank2]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 344, in <listcomp>
[rank2]:     block_shape = model_metadata["block_shape"]
[rank2]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 32.12 GiB. GPU 2 has a total capacity of 79.11 GiB of which 13.40 GiB is free. Including non-PyTorch memory, this process has 65.70 GiB memory in use. Of the allocated memory 64.24 GiB is allocated by PyTorch, and 4.74 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
dgx-35:1125061:1130785 [2] NCCL INFO [Service thread] Connection closed by localRank 1
dgx-35:1125061:1130785 [2] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1125061:1130785 [2] NCCL INFO [Service thread] Connection closed by localRank 3
[rank2]:[W102 05:51:12.521588734 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
dgx-35:1125061:1130785 [2] NCCL INFO [Service thread] Connection closed by localRank 2
dgx-35:1125061:1131882 [2] NCCL INFO comm 0x8370960 rank 2 nranks 8 cudaDev 2 busId 52000 - Abort COMPLETE
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 8 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_3_rank_0': [Errno 2] No such file or directory: '/block_3_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
