Rank [0]: using device 0, block_to_group_rank_map: {0: [0, 4], 1: [1, 5], 2: [2, 6], 3: [3, 7], 4: [0, 4], 5: [1, 5], 6: [2, 6], 7: [3, 7]}.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/15 [00:02<00:33,  2.36s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:04<00:29,  2.28s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:17<01:27,  7.33s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [00:35<02:04, 11.31s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [00:52<02:14, 13.48s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:09<02:12, 14.78s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:27<02:06, 15.77s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:45<01:53, 16.24s/it]Loading checkpoint shards:  60%|██████    | 9/15 [02:02<01:39, 16.61s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [02:19<01:23, 16.79s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [02:37<01:08, 17.11s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:54<00:51, 17.17s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [03:13<00:35, 17.70s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [03:32<00:17, 17.95s/it]Loading checkpoint shards: 100%|██████████| 15/15 [03:33<00:00, 12.88s/it]Loading checkpoint shards: 100%|██████████| 15/15 [03:33<00:00, 14.23s/it]
Rank [0]: 256.96(GB) memory occupied by model
Rank [0]: block_names: [SharedMemory('block_0_rank_0', size=34488324096), SharedMemory('block_1_rank_0', size=34488324096), SharedMemory('block_2_rank_0', size=34488324096), SharedMemory('block_3_rank_0', size=34488324096), SharedMemory('block_4_rank_0', size=34488324096), SharedMemory('block_5_rank_0', size=34488324096), SharedMemory('block_6_rank_0', size=34488324096), SharedMemory('block_7_rank_0', size=34488324096)]
[rank0]:[W102 05:50:14.936293299 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-35:1125059:1125059 [0] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.29<0>
dgx-35:1125059:1125059 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-35:1125059:1125059 [0] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-35:1125059:1125059 [0] NCCL INFO cudaDriverVersion 12020
NCCL version 2.21.5+cuda11.8
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [2]mlx5_2:1/RoCE [3]mlx5_3:1/IB [4]mlx5_4:1/IB [5]mlx5_5:1/IB [6]mlx5_6:1/IB [7]mlx5_7:1/IB [8]mlx5_8:1/RoCE [9]mlx5_9:1/IB [10]mlx5_10:1/IB [11]mlx5_11:1/IB [RO]; OOB ibp24s0:10.23.1.29<0>
dgx-35:1125059:1130706 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1125059:1130706 [0] NCCL INFO Using network IB
dgx-35:1125059:1130706 [0] NCCL INFO ncclCommInitRank comm 0x97d5200 rank 0 nranks 8 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xd44f7765c042782e - Init START
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-35:1125059:1130706 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-35:1125059:1130706 [0] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 4 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 5 (distance 4 <= 6), read 0
dgx-35:1125059:1130706 [0] NCCL INFO Setting affinity for GPU 0 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1125059:1130706 [0] NCCL INFO comm 0x97d5200 rank 0 nRanks 8 nNodes 2 localRanks 4 localRank 0 MNNVL 0
dgx-35:1125059:1130706 [0] NCCL INFO Channel 00/16 :    0   3   2   1   5   6   7   4
dgx-35:1125059:1130706 [0] NCCL INFO Channel 01/16 :    0   4   7   6   5   1   2   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 02/16 :    0   3   7   4   5   6   2   1
dgx-35:1125059:1130706 [0] NCCL INFO Channel 03/16 :    0   1   2   6   5   4   7   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 04/16 :    0   3   2   1   5   6   7   4
dgx-35:1125059:1130706 [0] NCCL INFO Channel 05/16 :    0   4   7   6   5   1   2   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 06/16 :    0   3   7   4   5   6   2   1
dgx-35:1125059:1130706 [0] NCCL INFO Channel 07/16 :    0   1   2   6   5   4   7   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 08/16 :    0   3   2   1   5   6   7   4
dgx-35:1125059:1130706 [0] NCCL INFO Channel 09/16 :    0   4   7   6   5   1   2   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 10/16 :    0   3   7   4   5   6   2   1
dgx-35:1125059:1130706 [0] NCCL INFO Channel 11/16 :    0   1   2   6   5   4   7   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 12/16 :    0   3   2   1   5   6   7   4
dgx-35:1125059:1130706 [0] NCCL INFO Channel 13/16 :    0   4   7   6   5   1   2   3
dgx-35:1125059:1130706 [0] NCCL INFO Channel 14/16 :    0   3   7   4   5   6   2   1
dgx-35:1125059:1130706 [0] NCCL INFO Channel 15/16 :    0   1   2   6   5   4   7   3
dgx-35:1125059:1130706 [0] NCCL INFO Trees [0] 1/4/-1->0->-1 [1] -1/-1/-1->0->3 [2] 1/-1/-1->0->3 [3] 1/-1/-1->0->3 [4] 1/4/-1->0->-1 [5] -1/-1/-1->0->3 [6] 1/-1/-1->0->3 [7] 1/-1/-1->0->3 [8] 1/-1/-1->0->4 [9] -1/-1/-1->0->3 [10] 1/-1/-1->0->3 [11] 1/-1/-1->0->3 [12] 1/-1/-1->0->4 [13] -1/-1/-1->0->3 [14] 1/-1/-1->0->3 [15] 1/-1/-1->0->3
dgx-35:1125059:1130706 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1125059:1130706 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 0 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc005db0
dgx-35:1125059:1130706 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 1 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc005e28
dgx-35:1125059:1130706 [0] NCCL INFO Channel 11/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 2 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc005ea0
dgx-35:1125059:1130706 [0] NCCL INFO Channel 15/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 3 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc005f18
dgx-35:1125059:1130706 [0] NCCL INFO Channel 00/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc005f90
dgx-35:1125059:1130706 [0] NCCL INFO Channel 02/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006008
dgx-35:1125059:1130706 [0] NCCL INFO Channel 04/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006080
dgx-35:1125059:1130706 [0] NCCL INFO Channel 06/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0060f8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 08/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006170
dgx-35:1125059:1130706 [0] NCCL INFO Channel 10/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 9 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0061e8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 12/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 10 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006260
dgx-35:1125059:1130706 [0] NCCL INFO Channel 14/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 11 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0062d8
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 12 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006350
dgx-35:1125059:1130706 [0] NCCL INFO Channel 00/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 13 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0063c8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 04/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 14 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006440
dgx-35:1125059:1130706 [0] NCCL INFO Channel 08/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 15 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0064b8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 12/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 16 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006530
dgx-35:1125059:1130706 [0] NCCL INFO Channel 01/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 17 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0065a8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 05/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 18 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006620
dgx-35:1125059:1130706 [0] NCCL INFO Channel 09/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 19 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006698
dgx-35:1125059:1130706 [0] NCCL INFO Channel 13/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 20 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006710
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 21 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006788
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 22 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006800
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 23 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006878
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 24 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0068f0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 25 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006968
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 26 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0069e0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 27 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006a58
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 28 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006ad0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 29 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006b48
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 30 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006bc0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 31 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006c38
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4668 mtu 5 LID 494 fifoRkey=0x16f1b1 fifoLkey=0x16f1b1
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4671 mtu 5 LID 494 fifoRkey=0x16e2a2 fifoLkey=0x16e2a2
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4674 mtu 5 LID 494 fifoRkey=0x17cf8a fifoLkey=0x17cf8a
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4677 mtu 5 LID 494 fifoRkey=0x168c4d fifoLkey=0x168c4d
dgx-35:1125059:1130706 [0] NCCL INFO Connected all rings
dgx-35:1125059:1130706 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 32 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006cb0
dgx-35:1125059:1130706 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 33 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006d28
dgx-35:1125059:1130706 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 34 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006da0
dgx-35:1125059:1130706 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 35 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006e18
dgx-35:1125059:1130706 [0] NCCL INFO Channel 08/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 36 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006e90
dgx-35:1125059:1130706 [0] NCCL INFO Channel 10/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 37 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006f08
dgx-35:1125059:1130706 [0] NCCL INFO Channel 12/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 38 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006f80
dgx-35:1125059:1130706 [0] NCCL INFO Channel 14/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 39 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc006ff8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 01/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 40 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007070
dgx-35:1125059:1130706 [0] NCCL INFO Channel 03/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 41 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0070e8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 05/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 42 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007160
dgx-35:1125059:1130706 [0] NCCL INFO Channel 07/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 43 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0071d8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 09/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 44 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007250
dgx-35:1125059:1130706 [0] NCCL INFO Channel 11/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 45 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0072c8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 13/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 46 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007340
dgx-35:1125059:1130706 [0] NCCL INFO Channel 15/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 47 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0073b8
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 48 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007430
dgx-35:1125059:1130706 [0] NCCL INFO Channel 00/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 49 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0074a8
dgx-35:1125059:1130706 [0] NCCL INFO Channel 04/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 50 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007520
dgx-35:1125059:1130706 [0] NCCL INFO Channel 08/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 51 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007598
dgx-35:1125059:1130706 [0] NCCL INFO Channel 12/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 52 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007610
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 53 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007688
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 54 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007700
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 55 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007778
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 56 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0077f0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 57 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007868
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 58 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0078e0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 59 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007958
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 60 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc0079d0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 61 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007a48
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 62 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007ac0
dgx-35:1125059:1130786 [0] NCCL INFO New proxy recv connection 63 from local rank 0, transport 0
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007b38
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4678 mtu 5 LID 494 fifoRkey=0x167333 fifoLkey=0x167333
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4679 mtu 5 LID 494 fifoRkey=0x179250 fifoLkey=0x179250
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4680 mtu 5 LID 494 fifoRkey=0x17bc7c fifoLkey=0x17bc7c
dgx-35:1125059:1130786 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4681 mtu 5 LID 494 fifoRkey=0x1704c4 fifoLkey=0x1704c4
dgx-35:1125059:1130706 [0] NCCL INFO Connected all trees
dgx-35:1125059:1130706 [0] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 512 | 512
dgx-35:1125059:1130706 [0] NCCL INFO 16 coll channels, 16 collnet channels, 0 nvls channels, 16 p2p channels, 2 p2p channels per peer
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 64 from local rank 0, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x150fdc007bb0
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 1
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 4 (distance 4 <= 6), read 1
dgx-35:1125059:1130706 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 5 (distance 4 <= 6), read 1
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 65 from local rank 2, transport 2
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 66 from local rank 3, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551f4007c28
dgx-35:1125059:1130786 [0] NCCL INFO New proxy send connection 67 from local rank 1, transport 2
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 2 -> connection 0x1551f4007c28
dgx-35:1125059:1130706 [0] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4007ca0
dgx-35:1125059:1130706 [0] NCCL INFO ncclCommInitRank comm 0x97d5200 rank 0 nranks 8 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xd44f7765c042782e - Init COMPLETE
Rank [0]: Received model_metadata: {'block_shape': torch.Size([8622081024])}
Rank [0]: blocks size 8
Rank [0]: Block 0 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0002956390380859375
Rank [0]: Block 1 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0002689361572265625
Rank [0]: Block 2 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.00439453125
Rank [0]: Block 3 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0087890625
Rank [0]: Block 4 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.00045013427734375
Rank [0]: Block 5 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.006683349609375
Rank [0]: Block 6 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0172119140625
Rank [0]: Block 7 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0091552734375
[rank0]: Traceback (most recent call last):
[rank0]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 428, in <module>
[rank0]:     main()
[rank0]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 425, in main
[rank0]:     broadcast_model(rank, world_size, model_name, args.num_blocks, args.use_multi_gpu)
[rank0]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 384, in broadcast_model
[rank0]:     broadcast_model_instance_across_gpu(rank, world_size, model_name, num_blocks)
[rank0]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 344, in broadcast_model_instance_across_gpu
[rank0]:     blocks_gpu = [torch.zeros(block_shape, dtype=torch.float32, device=f'cuda:{device_id}') for _ in range(num_blocks)]
[rank0]:   File "/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/RDMC-GDR/slurm/baseline/nccl_bcast.py", line 344, in <listcomp>
[rank0]:     blocks_gpu = [torch.zeros(block_shape, dtype=torch.float32, device=f'cuda:{device_id}') for _ in range(num_blocks)]
[rank0]: torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 32.12 GiB. GPU 0 has a total capacity of 79.11 GiB of which 13.40 GiB is free. Including non-PyTorch memory, this process has 65.70 GiB memory in use. Of the allocated memory 64.24 GiB is allocated by PyTorch, and 4.74 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
dgx-35:1125059:1130786 [0] NCCL INFO [Service thread] Connection closed by localRank 1
[rank0]:[W102 05:51:01.215744756 ProcessGroupNCCL.cpp:1250] Warning: WARNING: process group has NOT been destroyed before we destruct ProcessGroupNCCL. On normal program exit, the application should call destroy_process_group to ensure that any pending NCCL operations have finished in this process. In rare cases this process can exit before this point and block the progress of another member of the process group. This constraint has always been present,  but this warning has only been added since PyTorch 2.4 (function operator())
dgx-35:1125059:1130786 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1125059:1130786 [0] NCCL INFO [Service thread] Connection closed by localRank 3
dgx-35:1125059:1130786 [0] NCCL INFO [Service thread] Connection closed by localRank 2
dgx-35:1125059:1131626 [0] NCCL INFO comm 0x97d5200 rank 0 nranks 8 cudaDev 0 busId 1b000 - Abort COMPLETE
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 8 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
