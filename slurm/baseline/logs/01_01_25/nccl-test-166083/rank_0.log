Rank [0]: Total nodes: 2, using device 0, block_to_group_rank_map: {0: [0, 2], 1: [1, 3], 2: [0, 2], 3: [1, 3]}.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:02<00:02,  2.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.38s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:03<00:00,  1.53s/it]
Rank [0]: 25.10(GB) memory occupied by model
Rank [0]: block_names: [SharedMemory('block_0_rank_0', size=6738415616), SharedMemory('block_1_rank_0', size=6738415616), SharedMemory('block_2_rank_0', size=6738415616), SharedMemory('block_3_rank_0', size=6738415616)]
[rank0]:[W102 06:39:31.848129887 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-35:1189590:1189590 [0] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.29<0>
dgx-35:1189590:1189590 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-35:1189590:1189590 [0] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-35:1189590:1189590 [0] NCCL INFO cudaDriverVersion 12020
NCCL version 2.21.5+cuda11.8
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [2]mlx5_2:1/RoCE [3]mlx5_3:1/IB [4]mlx5_4:1/IB [5]mlx5_5:1/IB [6]mlx5_6:1/IB [7]mlx5_7:1/IB [8]mlx5_8:1/RoCE [9]mlx5_9:1/IB [10]mlx5_10:1/IB [11]mlx5_11:1/IB [RO]; OOB ibp24s0:10.23.1.29<0>
dgx-35:1189590:1189811 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1189590:1189811 [0] NCCL INFO Using network IB
dgx-35:1189590:1189811 [0] NCCL INFO ncclCommInitRank comm 0x935ec30 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc38f331997106562 - Init START
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-35:1189590:1189811 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-35:1189590:1189811 [0] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 3 (distance 4 <= 6), read 0
dgx-35:1189590:1189811 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-35:1189590:1189811 [0] NCCL INFO comm 0x935ec30 rank 0 nRanks 4 nNodes 2 localRanks 2 localRank 0 MNNVL 0
dgx-35:1189590:1189811 [0] NCCL INFO Channel 00/08 :    0   1   2   3
dgx-35:1189590:1189811 [0] NCCL INFO Channel 01/08 :    0   3   2   1
dgx-35:1189590:1189811 [0] NCCL INFO Channel 02/08 :    0   1   2   3
dgx-35:1189590:1189811 [0] NCCL INFO Channel 03/08 :    0   3   2   1
dgx-35:1189590:1189811 [0] NCCL INFO Channel 04/08 :    0   1   2   3
dgx-35:1189590:1189811 [0] NCCL INFO Channel 05/08 :    0   3   2   1
dgx-35:1189590:1189811 [0] NCCL INFO Channel 06/08 :    0   1   2   3
dgx-35:1189590:1189811 [0] NCCL INFO Channel 07/08 :    0   3   2   1
dgx-35:1189590:1189811 [0] NCCL INFO Trees [0] 1/2/-1->0->-1 [1] -1/-1/-1->0->1 [2] 1/2/-1->0->-1 [3] -1/-1/-1->0->1 [4] 1/-1/-1->0->2 [5] -1/-1/-1->0->1 [6] 1/-1/-1->0->2 [7] -1/-1/-1->0->1
dgx-35:1189590:1189811 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 1 from local rank 1, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38005db0
dgx-35:1189590:1189811 [0] NCCL INFO Channel 00/0 : 3[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38005ea0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 3 from local rank 1, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Channel 02/0 : 3[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 4 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38005f90
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 5 from local rank 1, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Channel 04/0 : 3[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 6 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006080
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 7 from local rank 1, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Channel 06/0 : 3[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006170
dgx-35:1189590:1189811 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 9 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380061e8
dgx-35:1189590:1189811 [0] NCCL INFO Channel 04/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 10 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006260
dgx-35:1189590:1189811 [0] NCCL INFO Channel 06/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 11 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380062d8
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 12 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006350
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 13 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380063c8
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 14 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006440
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 15 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380064b8
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006008
dgx-35:1189590:1189811 [0] NCCL INFO Channel 01/0 : 0[0] -> 3[1] [send] via NET/IB/3(1)/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec0060f8
dgx-35:1189590:1189811 [0] NCCL INFO Channel 03/0 : 0[0] -> 3[1] [send] via NET/IB/3(1)/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec0061e8
dgx-35:1189590:1189811 [0] NCCL INFO Channel 05/0 : 0[0] -> 3[1] [send] via NET/IB/3(1)/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006350
dgx-35:1189590:1189811 [0] NCCL INFO Channel 07/0 : 0[0] -> 3[1] [send] via NET/IB/3(1)/GDRDMA
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4814 mtu 5 LID 494 fifoRkey=0x175e1f fifoLkey=0x175e1f
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4817 mtu 5 LID 494 fifoRkey=0x176a2a fifoLkey=0x176a2a
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4818 mtu 5 LID 494 fifoRkey=0x173cff fifoLkey=0x173cff
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4821 mtu 5 LID 494 fifoRkey=0x1634f3 fifoLkey=0x1634f3
dgx-35:1189590:1189811 [0] NCCL INFO Connected all rings
dgx-35:1189590:1189811 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 16 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006530
dgx-35:1189590:1189811 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 17 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380065a8
dgx-35:1189590:1189811 [0] NCCL INFO Channel 05/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 18 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006620
dgx-35:1189590:1189811 [0] NCCL INFO Channel 07/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 19 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006698
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 20 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006710
dgx-35:1189590:1189811 [0] NCCL INFO Channel 00/0 : 2[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 21 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006788
dgx-35:1189590:1189811 [0] NCCL INFO Channel 02/0 : 2[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 22 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006800
dgx-35:1189590:1189811 [0] NCCL INFO Channel 04/0 : 2[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 23 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006878
dgx-35:1189590:1189811 [0] NCCL INFO Channel 06/0 : 2[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 24 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380068f0
dgx-35:1189590:1189811 [0] NCCL INFO Channel 00/0 : 0[0] -> 2[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 25 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006968
dgx-35:1189590:1189811 [0] NCCL INFO Channel 02/0 : 0[0] -> 2[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 26 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b380069e0
dgx-35:1189590:1189811 [0] NCCL INFO Channel 04/0 : 0[0] -> 2[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 27 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006a58
dgx-35:1189590:1189811 [0] NCCL INFO Channel 06/0 : 0[0] -> 2[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 28 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006ad0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 29 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006b48
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 30 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006bc0
dgx-35:1189590:1189839 [0] NCCL INFO New proxy recv connection 31 from local rank 0, transport 0
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006c38
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4826 mtu 5 LID 494 fifoRkey=0x168c4d fifoLkey=0x168c4d
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4827 mtu 5 LID 494 fifoRkey=0x16f1b1 fifoLkey=0x16f1b1
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4828 mtu 5 LID 494 fifoRkey=0x17cf8a fifoLkey=0x17cf8a
dgx-35:1189590:1189839 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4829 mtu 5 LID 494 fifoRkey=0x16e2a2 fifoLkey=0x16e2a2
dgx-35:1189590:1189811 [0] NCCL INFO Connected all trees
dgx-35:1189590:1189811 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
dgx-35:1189590:1189811 [0] NCCL INFO 8 coll channels, 8 collnet channels, 0 nvls channels, 8 p2p channels, 2 p2p channels per peer
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 32 from local rank 0, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x154b38006cb0
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189811 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 3 (distance 4 <= 6), read 1
dgx-35:1189590:1189839 [0] NCCL INFO New proxy send connection 33 from local rank 1, transport 2
dgx-35:1189590:1189811 [0] NCCL INFO Connected to proxy localRank 1 -> connection 0x1551ec006d28
dgx-35:1189590:1189811 [0] NCCL INFO ncclCommInitRank comm 0x935ec30 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc38f331997106562 - Init COMPLETE
Rank [0]: Received model_metadata: {'block_shape': torch.Size([1684603904])}
Rank [0]: blocks size 4
Rank [0]: Block 0 mapped with shape torch.Size([1684603904]), dtype torch.float32, 1.2516975402832031e-06
Rank [0]: Block 1 mapped with shape torch.Size([1684603904]), dtype torch.float32, -0.0059814453125
Rank [0]: Block 2 mapped with shape torch.Size([1684603904]), dtype torch.float32, -0.0289306640625
Rank [0]: Block 3 mapped with shape torch.Size([1684603904]), dtype torch.float32, 0.037109375
Rank [0]: Preparing GPU blocks...
Rank [0]: Total 2 blocks in device 0.
Rank [0]: Verifying block 0, 1.2516975402832031e-06
Rank [0]: Verifying block 2, -0.0289306640625
Rank [0]: Starting broadcast...
Rank [0]: broadcasting Block ID 0 calling from rank 0 for group [0, 2]...
dgx-35:1189590:1189955 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1189590:1189955 [0] NCCL INFO Using network IB
dgx-35:1189590:1189955 [0] NCCL INFO ncclCommInitRank comm 0x9b3e9f0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x37ad282a5e02e607 - Init START
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-35:1189590:1189955 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189955 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-35:1189590:1189955 [0] NCCL INFO comm 0x9b3e9f0 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1189590:1189955 [0] NCCL INFO Channel 00/04 :    0   1
dgx-35:1189590:1189955 [0] NCCL INFO Channel 01/04 :    0   1
dgx-35:1189590:1189955 [0] NCCL INFO Channel 02/04 :    0   1
dgx-35:1189590:1189955 [0] NCCL INFO Channel 03/04 :    0   1
dgx-35:1189590:1189955 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1189590:1189955 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189963 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8005dc0
dgx-35:1189590:1189955 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189963 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8005e38
dgx-35:1189590:1189955 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189963 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8005eb0
dgx-35:1189590:1189955 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189963 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8005f28
dgx-35:1189590:1189955 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189963 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8005fa0
dgx-35:1189590:1189955 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189963 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8006018
dgx-35:1189590:1189955 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189963 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8006090
dgx-35:1189590:1189955 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189955 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189963 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8006108
dgx-35:1189590:1189955 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189963 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4838 mtu 5 LID 494 fifoRkey=0x16bc7e fifoLkey=0x16bc7e
dgx-35:1189590:1189963 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4841 mtu 5 LID 494 fifoRkey=0x17da9a fifoLkey=0x17da9a
dgx-35:1189590:1189963 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4844 mtu 5 LID 494 fifoRkey=0x166826 fifoLkey=0x166826
dgx-35:1189590:1189963 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4845 mtu 5 LID 494 fifoRkey=0x1732f3 fifoLkey=0x1732f3
dgx-35:1189590:1189955 [0] NCCL INFO Connected all rings
dgx-35:1189590:1189955 [0] NCCL INFO Connected all trees
dgx-35:1189590:1189955 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1189590:1189955 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1189590:1189963 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1189590:1189955 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547d8006180
Rank [0]: broadcasting Block ID 2 calling from rank 0 for group [0, 2]...
dgx-35:1189590:1189955 [0] NCCL INFO ncclCommInitRank comm 0x9b3e9f0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x37ad282a5e02e607 - Init COMPLETE
dgx-35:1189590:1189970 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1189590:1189970 [0] NCCL INFO Using network IB
dgx-35:1189590:1189970 [0] NCCL INFO ncclCommInitRank comm 0x9b53b30 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc61c0e66c83fa3c8 - Init START
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 1 'mlx5_1'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 2 'mlx5_2'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 3 'mlx5_3'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 4 'mlx5_4'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 5 'mlx5_5'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 6 'mlx5_6'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 7 'mlx5_7'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 8 'mlx5_8'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 9 'mlx5_9'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 10 'mlx5_10'
dgx-35:1189590:1189970 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 11 'mlx5_11'
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189970 [0] NCCL INFO Setting affinity for GPU 0 to 03ff0000,00000000,00000000,000003ff
dgx-35:1189590:1189970 [0] NCCL INFO comm 0x9b53b30 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1189590:1189970 [0] NCCL INFO Channel 00/04 :    0   1
dgx-35:1189590:1189970 [0] NCCL INFO Channel 01/04 :    0   1
dgx-35:1189590:1189970 [0] NCCL INFO Channel 02/04 :    0   1
dgx-35:1189590:1189970 [0] NCCL INFO Channel 03/04 :    0   1
dgx-35:1189590:1189970 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1189590:1189970 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189977 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd470
dgx-35:1189590:1189970 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189977 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd4e8
dgx-35:1189590:1189970 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189977 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd560
dgx-35:1189590:1189970 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1189590:1189977 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd5d8
dgx-35:1189590:1189970 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189977 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd650
dgx-35:1189590:1189970 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189977 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd6c8
dgx-35:1189590:1189970 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189977 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd740
dgx-35:1189590:1189970 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189970 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1189590:1189977 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd7b8
dgx-35:1189590:1189970 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1189590:1189977 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4850 mtu 5 LID 494 fifoRkey=0x168140 fifoLkey=0x168140
dgx-35:1189590:1189977 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4853 mtu 5 LID 494 fifoRkey=0x179b5c fifoLkey=0x179b5c
dgx-35:1189590:1189977 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4854 mtu 5 LID 494 fifoRkey=0x174708 fifoLkey=0x174708
dgx-35:1189590:1189977 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 4855 mtu 5 LID 494 fifoRkey=0x16b172 fifoLkey=0x16b172
dgx-35:1189590:1189970 [0] NCCL INFO Connected all rings
dgx-35:1189590:1189970 [0] NCCL INFO Connected all trees
dgx-35:1189590:1189970 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1189590:1189970 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1189590:1189977 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1189590:1189970 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1547dcbbd830
dgx-35:1189590:1189970 [0] NCCL INFO ncclCommInitRank comm 0x9b53b30 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc61c0e66c83fa3c8 - Init COMPLETE
dgx-35:1189590:1189977 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1189590:1189989 [0] NCCL INFO comm 0x9b53b30 rank 0 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
dgx-35:1189590:1189963 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1189590:1189839 [0] NCCL INFO [Service thread] Connection closed by localRank 1
dgx-35:1189590:1190016 [0] NCCL INFO comm 0x9b3e9f0 rank 0 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
dgx-35:1189590:1189839 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1189590:1190025 [0] NCCL INFO comm 0x935ec30 rank 0 nranks 4 cudaDev 0 busId 1b000 - Abort COMPLETE
Rank [0]: Total Broadcast Time 650.741 ms
Rank [0]: verifying block 0 with 1.2516975402832031e-06
Rank [0]: verifying block 2 with -0.0289306640625
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 4 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_3_rank_0': [Errno 2] No such file or directory: '/block_3_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_2_rank_0': [Errno 2] No such file or directory: '/block_2_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_1_rank_0': [Errno 2] No such file or directory: '/block_1_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_0_rank_0': [Errno 2] No such file or directory: '/block_0_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
