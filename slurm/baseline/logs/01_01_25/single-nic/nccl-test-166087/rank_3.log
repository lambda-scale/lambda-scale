Rank [3]: Total nodes: 2, using device 3, block_to_group_rank_map: {0: [0, 4], 1: [1, 5], 2: [2, 6], 3: [3, 7], 4: [0, 4], 5: [1, 5], 6: [2, 6], 7: [3, 7]}.
[rank3]:[W102 07:15:59.104711001 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-35:1237913:1237913 [3] NCCL INFO cudaDriverVersion 12020
dgx-35:1237913:1237913 [3] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.29<0>
dgx-35:1237913:1237913 [3] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-35:1237913:1237913 [3] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-35:1237913:1241950 [3] NCCL INFO NCCL_IB_HCA set to mlx5_0
dgx-35:1237913:1241950 [3] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ibp24s0:10.23.1.29<0>
dgx-35:1237913:1241950 [3] NCCL INFO Using non-device net plugin version 0
dgx-35:1237913:1241950 [3] NCCL INFO Using network IB
dgx-35:1237913:1241950 [3] NCCL INFO ncclCommInitRank comm 0x836dc90 rank 3 nranks 8 cudaDev 3 nvmlDev 3 busId 61000 commId 0x1ba77d6a45ec8f0e - Init START
dgx-35:1237913:1241950 [3] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237913:1241950 [3] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237913:1241950 [3] NCCL INFO Setting affinity for GPU 3 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237913:1241950 [3] NCCL INFO comm 0x836dc90 rank 3 nRanks 8 nNodes 2 localRanks 4 localRank 3 MNNVL 0
dgx-35:1237913:1241950 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2 [2] -1/-1/-1->3->2 [3] -1/-1/-1->3->2
dgx-35:1237913:1241950 [3] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 0 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4005db0
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 1 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4005e28
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 2 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4005ea0
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 3 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4005f18
dgx-35:1237913:1241950 [3] NCCL INFO Channel 00/0 : 3[3] -> 2[2] via P2P/CUMEM
dgx-35:1237913:1241970 [3] NCCL INFO New proxy send connection 4 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4005f90
dgx-35:1237913:1241950 [3] NCCL INFO Channel 01/0 : 3[3] -> 2[2] via P2P/CUMEM
dgx-35:1237913:1241970 [3] NCCL INFO New proxy send connection 5 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4006008
dgx-35:1237913:1241950 [3] NCCL INFO Channel 02/0 : 3[3] -> 2[2] via P2P/CUMEM
dgx-35:1237913:1241970 [3] NCCL INFO New proxy send connection 6 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4006080
dgx-35:1237913:1241950 [3] NCCL INFO Channel 03/0 : 3[3] -> 2[2] via P2P/CUMEM
dgx-35:1237913:1241970 [3] NCCL INFO New proxy send connection 7 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f40060f8
dgx-35:1237913:1241950 [3] NCCL INFO Connected all rings
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 8 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4006170
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 9 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f40061e8
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 10 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4006260
dgx-35:1237913:1241970 [3] NCCL INFO New proxy recv connection 11 from local rank 3, transport 0
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f40062d8
dgx-35:1237913:1241950 [3] NCCL INFO Connected all trees
dgx-35:1237913:1241950 [3] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 512 | 512
dgx-35:1237913:1241950 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237913:1241970 [3] NCCL INFO New proxy send connection 12 from local rank 3, transport 2
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 3 -> connection 0x1551f4006350
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237913:1241950 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240068f0
dgx-35:1237913:1241950 [3] NCCL INFO ncclCommInitRank comm 0x836dc90 rank 3 nranks 8 cudaDev 3 nvmlDev 3 busId 61000 commId 0x1ba77d6a45ec8f0e - Init COMPLETE
Rank [3]: block_names: ['block_0_rank_0', 'block_1_rank_0', 'block_2_rank_0', 'block_3_rank_0', 'block_4_rank_0', 'block_5_rank_0', 'block_6_rank_0', 'block_7_rank_0']
Rank [3]: Received model_metadata: {'block_shape': torch.Size([8622081024])}
Rank [3]: blocks size 8
Rank [3]: Block 0 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0002956390380859375
Rank [3]: Block 1 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0002689361572265625
Rank [3]: Block 2 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.00439453125
Rank [3]: Block 3 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0087890625
Rank [3]: Block 4 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.00045013427734375
Rank [3]: Block 5 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.006683349609375
Rank [3]: Block 6 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0172119140625
Rank [3]: Block 7 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0091552734375
Rank [3]: Preparing GPU blocks...
Rank [3]: Total 2 blocks in device 3.
Rank [3]: Verifying block 3, 0.0087890625
Rank [3]: Verifying block 7, -0.0091552734375
Rank [3]: broadcasting Block ID 3 calling from rank 3 for group [3, 7]...
NCCL version 2.21.5+cuda11.8
dgx-35:1237913:1242830 [3] NCCL INFO Using non-device net plugin version 0
dgx-35:1237913:1242830 [3] NCCL INFO Using network IB
dgx-35:1237913:1242830 [3] NCCL INFO ncclCommInitRank comm 0x8b6a9a0 rank 0 nranks 2 cudaDev 3 nvmlDev 3 busId 61000 commId 0xf2e6df599844f6bb - Init START
dgx-35:1237913:1242830 [3] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237913:1242830 [3] NCCL INFO Setting affinity for GPU 3 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237913:1242830 [3] NCCL INFO comm 0x8b6a9a0 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1237913:1242830 [3] NCCL INFO Channel 00/04 :    0   1
dgx-35:1237913:1242830 [3] NCCL INFO Channel 01/04 :    0   1
dgx-35:1237913:1242830 [3] NCCL INFO Channel 02/04 :    0   1
dgx-35:1237913:1242830 [3] NCCL INFO Channel 03/04 :    0   1
dgx-35:1237913:1242830 [3] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1237913:1242830 [3] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242832 [3] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4005dc0
dgx-35:1237913:1242830 [3] NCCL INFO Channel 00/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242832 [3] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4005e38
dgx-35:1237913:1242830 [3] NCCL INFO Channel 01/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242832 [3] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4005eb0
dgx-35:1237913:1242830 [3] NCCL INFO Channel 02/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242832 [3] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4005f28
dgx-35:1237913:1242830 [3] NCCL INFO Channel 03/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242832 [3] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4005fa0
dgx-35:1237913:1242830 [3] NCCL INFO Channel 00/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242832 [3] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4006018
dgx-35:1237913:1242830 [3] NCCL INFO Channel 01/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242832 [3] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4006090
dgx-35:1237913:1242830 [3] NCCL INFO Channel 02/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242830 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242832 [3] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4006108
dgx-35:1237913:1242830 [3] NCCL INFO Channel 03/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242832 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5247 mtu 5 LID 494 fifoRkey=0x1728e9 fifoLkey=0x1728e9
dgx-35:1237913:1242832 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5253 mtu 5 LID 494 fifoRkey=0x15601f fifoLkey=0x15601f
dgx-35:1237913:1242832 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5255 mtu 5 LID 494 fifoRkey=0x14c284 fifoLkey=0x14c284
dgx-35:1237913:1242832 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5257 mtu 5 LID 494 fifoRkey=0x145d1e fifoLkey=0x145d1e
dgx-35:1237913:1242830 [3] NCCL INFO Connected all rings
dgx-35:1237913:1242830 [3] NCCL INFO Connected all trees
dgx-35:1237913:1242830 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1237913:1242830 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237913:1242832 [3] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1237913:1242830 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x153fa4006180
Rank [3]: broadcasting Block ID 7 calling from rank 3 for group [3, 7]...
dgx-35:1237913:1242830 [3] NCCL INFO ncclCommInitRank comm 0x8b6a9a0 rank 0 nranks 2 cudaDev 3 nvmlDev 3 busId 61000 commId 0xf2e6df599844f6bb - Init COMPLETE
dgx-35:1237913:1242847 [3] NCCL INFO Using non-device net plugin version 0
dgx-35:1237913:1242847 [3] NCCL INFO Using network IB
dgx-35:1237913:1242847 [3] NCCL INFO ncclCommInitRank comm 0x8b7fca0 rank 0 nranks 2 cudaDev 3 nvmlDev 3 busId 61000 commId 0x8cb9a07dd304cc8d - Init START
dgx-35:1237913:1242847 [3] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237913:1242847 [3] NCCL INFO Setting affinity for GPU 3 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237913:1242847 [3] NCCL INFO comm 0x8b7fca0 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1237913:1242847 [3] NCCL INFO Channel 00/04 :    0   1
dgx-35:1237913:1242847 [3] NCCL INFO Channel 01/04 :    0   1
dgx-35:1237913:1242847 [3] NCCL INFO Channel 02/04 :    0   1
dgx-35:1237913:1242847 [3] NCCL INFO Channel 03/04 :    0   1
dgx-35:1237913:1242847 [3] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1237913:1242847 [3] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242852 [3] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4005dc0
dgx-35:1237913:1242847 [3] NCCL INFO Channel 00/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242852 [3] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4005e38
dgx-35:1237913:1242847 [3] NCCL INFO Channel 01/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242852 [3] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4005eb0
dgx-35:1237913:1242847 [3] NCCL INFO Channel 02/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 0
dgx-35:1237913:1242852 [3] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4005f28
dgx-35:1237913:1242847 [3] NCCL INFO Channel 03/0 : 1[3] -> 0[3] [receive] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242852 [3] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4005fa0
dgx-35:1237913:1242847 [3] NCCL INFO Channel 00/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242852 [3] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4006018
dgx-35:1237913:1242847 [3] NCCL INFO Channel 01/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242852 [3] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4006090
dgx-35:1237913:1242847 [3] NCCL INFO Channel 02/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242847 [3] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 6 <= 6), read 1
dgx-35:1237913:1242852 [3] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4006108
dgx-35:1237913:1242847 [3] NCCL INFO Channel 03/0 : 0[3] -> 1[3] [send] via NET/IB/0/GDRDMA
dgx-35:1237913:1242852 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5294 mtu 5 LID 494 fifoRkey=0x15a263 fifoLkey=0x15a263
dgx-35:1237913:1242852 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5297 mtu 5 LID 494 fifoRkey=0x179b5c fifoLkey=0x179b5c
dgx-35:1237913:1242852 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5311 mtu 5 LID 494 fifoRkey=0x16c787 fifoLkey=0x16c787
dgx-35:1237913:1242852 [3] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5323 mtu 5 LID 494 fifoRkey=0x1530f0 fifoLkey=0x1530f0
dgx-35:1237913:1242847 [3] NCCL INFO Connected all rings
dgx-35:1237913:1242847 [3] NCCL INFO Connected all trees
dgx-35:1237913:1242847 [3] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1237913:1242847 [3] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237913:1242852 [3] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1237913:1242847 [3] NCCL INFO Connected to proxy localRank 0 -> connection 0x1551a4006180
dgx-35:1237913:1242847 [3] NCCL INFO ncclCommInitRank comm 0x8b7fca0 rank 0 nranks 2 cudaDev 3 nvmlDev 3 busId 61000 commId 0x8cb9a07dd304cc8d - Init COMPLETE
dgx-35:1237913:1242852 [3] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1237913:1242872 [3] NCCL INFO comm 0x8b7fca0 rank 0 nranks 2 cudaDev 3 busId 61000 - Abort COMPLETE
dgx-35:1237913:1242832 [3] NCCL INFO [Service thread] Connection closed by localRank 0
[rank3]:[E102 07:20:06.498990805 ProcessGroupNCCL.cpp:542] [Rank 0] Collective WorkNCCL(SeqNum=1, OpType=BROADCAST, NumelIn=8622081024, NumelOut=8622081024, Timeout(ms)=600000) raised the following async exception: NCCL error: unhandled system error (run with NCCL_DEBUG=INFO for details), NCCL version 2.21.5
ncclSystemError: System call (e.g. socket, malloc) or external library call failed or device error. 
Last error:

Exception raised from checkForNCCLErrorsInternal at /opt/conda/conda-bld/pytorch_1729647327489/work/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:2027 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1554e85e8446 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::checkForNCCLErrorsInternal(std::shared_ptr<c10d::NCCLComm>&) + 0x220 (0x1554e990abd0 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::WorkNCCL::checkAndSetException() + 0x7c (0x1554e990ae1c in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::WorkNCCL::isStarted() + 0x90 (0x1554e990b0f0 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: c10d::ProcessGroupNCCL::watchdogHandler() + 0x9f8 (0x1554e9912fc8 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #5: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x1554e991426d in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0x145c0 (0x15554d30a5c0 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #7: <unknown function> + 0x94ac3 (0x15555527dac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126a40 (0x15555530fa40 in /lib/x86_64-linux-gnu/libc.so.6)

dgx-35:1237913:1243010 [3] NCCL INFO comm 0x8b6a9a0 rank 0 nranks 2 cudaDev 3 busId 61000 - Abort COMPLETE
dgx-35:1237913:1241970 [3] NCCL INFO [Service thread] Connection closed by localRank 3
dgx-35:1237913:1243013 [3] NCCL INFO comm 0x836dc90 rank 3 nranks 8 cudaDev 3 busId 61000 - Abort COMPLETE
Rank [3]: verifying block 3 with 0.0087890625
Rank [3]: verifying block 7 with -0.0091552734375
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 8 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_4_rank_0': [Errno 2] No such file or directory: '/block_4_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_7_rank_0': [Errno 2] No such file or directory: '/block_7_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_2_rank_0': [Errno 2] No such file or directory: '/block_2_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_1_rank_0': [Errno 2] No such file or directory: '/block_1_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
