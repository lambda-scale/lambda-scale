Rank [0]: Total nodes: 2, using device 0, block_to_group_rank_map: {0: [0, 4], 1: [1, 5], 2: [2, 6], 3: [3, 7], 4: [0, 4], 5: [1, 5], 6: [2, 6], 7: [3, 7]}.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|▋         | 1/15 [00:17<04:06, 17.63s/it]Loading checkpoint shards:  13%|█▎        | 2/15 [00:34<03:47, 17.47s/it]Loading checkpoint shards:  20%|██        | 3/15 [00:52<03:31, 17.66s/it]Loading checkpoint shards:  27%|██▋       | 4/15 [01:01<02:34, 14.03s/it]Loading checkpoint shards:  33%|███▎      | 5/15 [01:09<02:00, 12.09s/it]Loading checkpoint shards:  40%|████      | 6/15 [01:22<01:49, 12.21s/it]Loading checkpoint shards:  47%|████▋     | 7/15 [01:32<01:32, 11.61s/it]Loading checkpoint shards:  53%|█████▎    | 8/15 [01:43<01:18, 11.19s/it]Loading checkpoint shards:  60%|██████    | 9/15 [01:53<01:05, 10.93s/it]Loading checkpoint shards:  67%|██████▋   | 10/15 [02:03<00:53, 10.60s/it]Loading checkpoint shards:  73%|███████▎  | 11/15 [02:05<00:32,  8.01s/it]Loading checkpoint shards:  80%|████████  | 12/15 [02:15<00:26,  8.69s/it]Loading checkpoint shards:  87%|████████▋ | 13/15 [02:17<00:13,  6.71s/it]Loading checkpoint shards:  93%|█████████▎| 14/15 [02:19<00:05,  5.31s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:20<00:00,  3.76s/it]Loading checkpoint shards: 100%|██████████| 15/15 [02:20<00:00,  9.34s/it]
Rank [0]: 256.96(GB) memory occupied by model
Rank [0]: block_names: [SharedMemory('block_0_rank_0', size=34488324096), SharedMemory('block_1_rank_0', size=34488324096), SharedMemory('block_2_rank_0', size=34488324096), SharedMemory('block_3_rank_0', size=34488324096), SharedMemory('block_4_rank_0', size=34488324096), SharedMemory('block_5_rank_0', size=34488324096), SharedMemory('block_6_rank_0', size=34488324096), SharedMemory('block_7_rank_0', size=34488324096)]
[rank0]:[W102 07:19:12.850423941 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
dgx-35:1237910:1237910 [0] NCCL INFO Bootstrap : Using ibp24s0:10.23.1.29<0>
dgx-35:1237910:1237910 [0] NCCL INFO NET/Plugin: No plugin found (libnccl-net.so)
dgx-35:1237910:1237910 [0] NCCL INFO NET/Plugin: Using internal network plugin.
dgx-35:1237910:1237910 [0] NCCL INFO cudaDriverVersion 12020
NCCL version 2.21.5+cuda11.8
dgx-35:1237910:1241947 [0] NCCL INFO NCCL_IB_HCA set to mlx5_0
dgx-35:1237910:1241947 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [RO]; OOB ibp24s0:10.23.1.29<0>
dgx-35:1237910:1241947 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1237910:1241947 [0] NCCL INFO Using network IB
dgx-35:1237910:1241947 [0] NCCL INFO ncclCommInitRank comm 0x97d5940 rank 0 nranks 8 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1ba77d6a45ec8f0e - Init START
dgx-35:1237910:1241947 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237910:1241947 [0] NCCL INFO NCCL_NET_GDR_LEVEL set by environment to PHB
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 43000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 52000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 61000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241947 [0] NCCL INFO Setting affinity for GPU 0 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237910:1241947 [0] NCCL INFO comm 0x97d5940 rank 0 nRanks 8 nNodes 2 localRanks 4 localRank 0 MNNVL 0
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/04 :    0   3   2   1   4   7   6   5
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/04 :    0   3   2   1   4   7   6   5
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/04 :    0   3   2   1   4   7   6   5
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/04 :    0   3   2   1   4   7   6   5
dgx-35:1237910:1241947 [0] NCCL INFO Trees [0] 1/4/-1->0->-1 [1] 1/4/-1->0->-1 [2] 1/-1/-1->0->4 [3] 1/-1/-1->0->4
dgx-35:1237910:1241947 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 0 from local rank 1, transport 2
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024005e28
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/0 : 5[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 2 from local rank 1, transport 2
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024005f18
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/0 : 5[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 4 from local rank 1, transport 2
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 5 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006008
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/0 : 5[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 6 from local rank 1, transport 2
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 7 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240060f8
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/0 : 5[1] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006170
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 9 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240061e8
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 10 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006260
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/0 : 0[0] -> 3[3] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 11 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240062d8
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5222 mtu 5 LID 494 fifoRkey=0x173cff fifoLkey=0x173cff
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5223 mtu 5 LID 494 fifoRkey=0x16f1b1 fifoLkey=0x16f1b1
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5224 mtu 5 LID 494 fifoRkey=0x16a665 fifoLkey=0x16a665
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5225 mtu 5 LID 494 fifoRkey=0x17cf8a fifoLkey=0x17cf8a
dgx-35:1237910:1241947 [0] NCCL INFO Connected all rings
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 12 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006350
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 13 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240063c8
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 14 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006440
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[1] via P2P/CUMEM
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 15 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240064b8
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 16 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006530
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 17 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240065a8
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 18 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006620
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 19 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006698
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/0 : 4[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 20 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006710
dgx-35:1237910:1241947 [0] NCCL INFO Channel 00/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 21 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006788
dgx-35:1237910:1241947 [0] NCCL INFO Channel 01/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 22 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006800
dgx-35:1237910:1241947 [0] NCCL INFO Channel 02/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1241947 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 23 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006878
dgx-35:1237910:1241947 [0] NCCL INFO Channel 03/0 : 0[0] -> 4[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 24 from local rank 3, transport 2
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 25 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006968
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 26 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x1510240069e0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 27 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006a58
dgx-35:1237910:1241973 [0] NCCL INFO New proxy recv connection 28 from local rank 0, transport 0
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006ad0
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5234 mtu 5 LID 494 fifoRkey=0x17da9a fifoLkey=0x17da9a
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5235 mtu 5 LID 494 fifoRkey=0x1732f3 fifoLkey=0x1732f3
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5236 mtu 5 LID 494 fifoRkey=0x167333 fifoLkey=0x167333
dgx-35:1237910:1241973 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5237 mtu 5 LID 494 fifoRkey=0x175e1f fifoLkey=0x175e1f
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 29 from local rank 2, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected all trees
dgx-35:1237910:1241947 [0] NCCL INFO threadThresholds 8/8/64 | 64/8/64 | 512 | 512
dgx-35:1237910:1241947 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 30 from local rank 0, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x151024006bc0
dgx-35:1237910:1241973 [0] NCCL INFO New proxy send connection 31 from local rank 1, transport 2
dgx-35:1237910:1241947 [0] NCCL INFO ncclCommInitRank comm 0x97d5940 rank 0 nranks 8 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1ba77d6a45ec8f0e - Init COMPLETE
Rank [0]: Received model_metadata: {'block_shape': torch.Size([8622081024])}
Rank [0]: blocks size 8
Rank [0]: Block 0 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0002956390380859375
Rank [0]: Block 1 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0002689361572265625
Rank [0]: Block 2 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.00439453125
Rank [0]: Block 3 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.0087890625
Rank [0]: Block 4 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.00045013427734375
Rank [0]: Block 5 mapped with shape torch.Size([8622081024]), dtype torch.float32, 0.006683349609375
Rank [0]: Block 6 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0172119140625
Rank [0]: Block 7 mapped with shape torch.Size([8622081024]), dtype torch.float32, -0.0091552734375
Rank [0]: Preparing GPU blocks...
Rank [0]: Total 2 blocks in device 0.
Rank [0]: Verifying block 0, 0.0002956390380859375
Rank [0]: Verifying block 4, -0.00045013427734375
Rank [0]: Starting broadcast...
Rank [0]: broadcasting Block ID 0 calling from rank 0 for group [0, 4]...
dgx-35:1237910:1242828 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1237910:1242828 [0] NCCL INFO Using network IB
dgx-35:1237910:1242828 [0] NCCL INFO ncclCommInitRank comm 0x9fb5a30 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1ec8d0d00ff1a11c - Init START
dgx-35:1237910:1242828 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242828 [0] NCCL INFO Setting affinity for GPU 0 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237910:1242828 [0] NCCL INFO comm 0x9fb5a30 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1237910:1242828 [0] NCCL INFO Channel 00/04 :    0   1
dgx-35:1237910:1242828 [0] NCCL INFO Channel 01/04 :    0   1
dgx-35:1237910:1242828 [0] NCCL INFO Channel 02/04 :    0   1
dgx-35:1237910:1242828 [0] NCCL INFO Channel 03/04 :    0   1
dgx-35:1237910:1242828 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1237910:1242828 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242841 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4005dc0
dgx-35:1237910:1242828 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242841 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4005e38
dgx-35:1237910:1242828 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242841 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4005eb0
dgx-35:1237910:1242828 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242841 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4005f28
dgx-35:1237910:1242828 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242841 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4005fa0
dgx-35:1237910:1242828 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242841 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4006018
dgx-35:1237910:1242828 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242841 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4006090
dgx-35:1237910:1242828 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242828 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242841 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4006108
dgx-35:1237910:1242828 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242841 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5273 mtu 5 LID 494 fifoRkey=0x15e1a1 fifoLkey=0x15e1a1
dgx-35:1237910:1242841 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5278 mtu 5 LID 494 fifoRkey=0x143eff fifoLkey=0x143eff
dgx-35:1237910:1242841 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5288 mtu 5 LID 494 fifoRkey=0x168140 fifoLkey=0x168140
dgx-35:1237910:1242841 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5291 mtu 5 LID 494 fifoRkey=0x16b172 fifoLkey=0x16b172
dgx-35:1237910:1242828 [0] NCCL INFO Connected all rings
dgx-35:1237910:1242828 [0] NCCL INFO Connected all trees
dgx-35:1237910:1242828 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1237910:1242828 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237910:1242841 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1237910:1242828 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd4006180
Rank [0]: broadcasting Block ID 4 calling from rank 0 for group [0, 4]...
dgx-35:1237910:1242828 [0] NCCL INFO ncclCommInitRank comm 0x9fb5a30 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0x1ec8d0d00ff1a11c - Init COMPLETE
dgx-35:1237910:1242851 [0] NCCL INFO Using non-device net plugin version 0
dgx-35:1237910:1242851 [0] NCCL INFO Using network IB
dgx-35:1237910:1242851 [0] NCCL INFO ncclCommInitRank comm 0x9fcabc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc5b7eb54b509c70a - Init START
dgx-35:1237910:1242851 [0] NCCL INFO NET/IB : GPU Direct RDMA Enabled for HCA 0 'mlx5_0'
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242851 [0] NCCL INFO Setting affinity for GPU 0 to 0fffff,ffff0000,00000000,0000000f,ffffffff
dgx-35:1237910:1242851 [0] NCCL INFO comm 0x9fcabc0 rank 0 nRanks 2 nNodes 2 localRanks 1 localRank 0 MNNVL 0
dgx-35:1237910:1242851 [0] NCCL INFO Channel 00/04 :    0   1
dgx-35:1237910:1242851 [0] NCCL INFO Channel 01/04 :    0   1
dgx-35:1237910:1242851 [0] NCCL INFO Channel 02/04 :    0   1
dgx-35:1237910:1242851 [0] NCCL INFO Channel 03/04 :    0   1
dgx-35:1237910:1242851 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1 [2] -1/-1/-1->0->1 [3] -1/-1/-1->0->1
dgx-35:1237910:1242851 [0] NCCL INFO P2P Chunksize set to 131072
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242862 [0] NCCL INFO New proxy recv connection 0 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd80950a0
dgx-35:1237910:1242851 [0] NCCL INFO Channel 00/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242862 [0] NCCL INFO New proxy recv connection 1 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095118
dgx-35:1237910:1242851 [0] NCCL INFO Channel 01/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242862 [0] NCCL INFO New proxy recv connection 2 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095190
dgx-35:1237910:1242851 [0] NCCL INFO Channel 02/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 0
dgx-35:1237910:1242862 [0] NCCL INFO New proxy recv connection 3 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095208
dgx-35:1237910:1242851 [0] NCCL INFO Channel 03/0 : 1[0] -> 0[0] [receive] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242862 [0] NCCL INFO New proxy send connection 4 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095280
dgx-35:1237910:1242851 [0] NCCL INFO Channel 00/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242862 [0] NCCL INFO New proxy send connection 5 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd80952f8
dgx-35:1237910:1242851 [0] NCCL INFO Channel 01/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242862 [0] NCCL INFO New proxy send connection 6 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095370
dgx-35:1237910:1242851 [0] NCCL INFO Channel 02/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242851 [0] NCCL INFO GPU Direct RDMA Enabled for GPU 1b000 / HCA 0 (distance 4 <= 6), read 1
dgx-35:1237910:1242862 [0] NCCL INFO New proxy send connection 7 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd80953e8
dgx-35:1237910:1242851 [0] NCCL INFO Channel 03/0 : 0[0] -> 1[0] [send] via NET/IB/0/GDRDMA
dgx-35:1237910:1242862 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5330 mtu 5 LID 494 fifoRkey=0x1235f6 fifoLkey=0x1235f6
dgx-35:1237910:1242862 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5333 mtu 5 LID 494 fifoRkey=0x121ee0 fifoLkey=0x121ee0
dgx-35:1237910:1242862 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5336 mtu 5 LID 494 fifoRkey=0x128547 fifoLkey=0x128547
dgx-35:1237910:1242862 [0] NCCL INFO NET/IB: NCCL Dev 0 IbDev 0 Port 1 qpn 5337 mtu 5 LID 494 fifoRkey=0x125818 fifoLkey=0x125818
dgx-35:1237910:1242851 [0] NCCL INFO Connected all rings
dgx-35:1237910:1242851 [0] NCCL INFO Connected all trees
dgx-35:1237910:1242851 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
dgx-35:1237910:1242851 [0] NCCL INFO 4 coll channels, 4 collnet channels, 0 nvls channels, 4 p2p channels, 2 p2p channels per peer
dgx-35:1237910:1242862 [0] NCCL INFO New proxy send connection 8 from local rank 0, transport 2
dgx-35:1237910:1242851 [0] NCCL INFO Connected to proxy localRank 0 -> connection 0x14ffd8095460
dgx-35:1237910:1242851 [0] NCCL INFO ncclCommInitRank comm 0x9fcabc0 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 1b000 commId 0xc5b7eb54b509c70a - Init COMPLETE
dgx-35:1237910:1241973 [0] NCCL INFO [Service thread] Connection closed by localRank 2
dgx-35:1237910:1241973 [0] NCCL INFO [Service thread] Connection closed by localRank 3
dgx-35:1237910:1242862 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1237910:1242869 [0] NCCL INFO comm 0x9fcabc0 rank 0 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
dgx-35:1237910:1242841 [0] NCCL INFO [Service thread] Connection closed by localRank 0
[rank0]:[E102 07:20:07.082469486 ProcessGroupNCCL.cpp:542] [Rank 0] Collective WorkNCCL(SeqNum=1, OpType=BROADCAST, NumelIn=8622081024, NumelOut=8622081024, Timeout(ms)=600000) raised the following async exception: NCCL error: unhandled system error (run with NCCL_DEBUG=INFO for details), NCCL version 2.21.5
ncclSystemError: System call (e.g. socket, malloc) or external library call failed or device error. 
Last error:

Exception raised from checkForNCCLErrorsInternal at /opt/conda/conda-bld/pytorch_1729647327489/work/torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:2027 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x96 (0x1554e85e8446 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libc10.so)
frame #1: c10d::ProcessGroupNCCL::checkForNCCLErrorsInternal(std::shared_ptr<c10d::NCCLComm>&) + 0x220 (0x1554e990abd0 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #2: c10d::ProcessGroupNCCL::WorkNCCL::checkAndSetException() + 0x7c (0x1554e990ae1c in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #3: c10d::ProcessGroupNCCL::WorkNCCL::isCompleted() + 0x90 (0x1554e990b030 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #4: c10d::ProcessGroupNCCL::watchdogHandler() + 0x1da (0x1554e99127aa in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #5: c10d::ProcessGroupNCCL::ncclCommWatchdog() + 0x14d (0x1554e991426d in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0x145c0 (0x15554d30a5c0 in /scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/site-packages/torch/lib/libtorch.so)
frame #7: <unknown function> + 0x94ac3 (0x15555527dac3 in /lib/x86_64-linux-gnu/libc.so.6)
frame #8: <unknown function> + 0x126a40 (0x15555530fa40 in /lib/x86_64-linux-gnu/libc.so.6)

dgx-35:1237910:1243014 [0] NCCL INFO comm 0x9fb5a30 rank 0 nranks 2 cudaDev 0 busId 1b000 - Abort COMPLETE
dgx-35:1237910:1241973 [0] NCCL INFO [Service thread] Connection closed by localRank 0
dgx-35:1237910:1241973 [0] NCCL INFO [Service thread] Connection closed by localRank 1
dgx-35:1237910:1243016 [0] NCCL INFO comm 0x97d5940 rank 0 nranks 8 cudaDev 0 busId 1b000 - Abort COMPLETE
Rank [0]: Total Broadcast Time 4077.189 ms
Rank [0]: verifying block 0 with 0.0002956390380859375
Rank [0]: verifying block 4 with -0.00045013427734375
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 8 leaked shared_memory objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_3_rank_0': [Errno 2] No such file or directory: '/block_3_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_0_rank_0': [Errno 2] No such file or directory: '/block_0_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_5_rank_0': [Errno 2] No such file or directory: '/block_5_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_1_rank_0': [Errno 2] No such file or directory: '/block_1_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_7_rank_0': [Errno 2] No such file or directory: '/block_7_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_2_rank_0': [Errno 2] No such file or directory: '/block_2_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_4_rank_0': [Errno 2] No such file or directory: '/block_4_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
/scratch/infattllm/fgscaling/rui/slurm_nodes/workspace/miniconda3/envs/py310_env/lib/python3.10/multiprocessing/resource_tracker.py:237: UserWarning: resource_tracker: '/block_6_rank_0': [Errno 2] No such file or directory: '/block_6_rank_0'
  warnings.warn('resource_tracker: %r: %s' % (name, e))
